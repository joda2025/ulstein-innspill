<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="nn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Innspel til Ulstein kommune sin sentrumsplan - Testside</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.20.15/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
  <div id="root"></div>
  <script type="text/babel">
    function App() {
      const [name, setName] = React.useState('');
      const [letter, setLetter] = React.useState('');
      const [error, setError] = React.useState('');
      const [copySuccess, setCopySuccess] = React.useState('');

      React.useEffect(() => {
        if (letter) {
          const letterElement = document.querySelector('.letter-section');
          if (letterElement) {
            letterElement.scrollIntoView({ behavior: 'smooth' });
          }
        }
      }, [letter]);

      const letterTemplates = [
        `Innspel til Ulstein kommune sin sentrumsplan
Dato: \${date}

Kjøre Ulstein kommune,

Eg, \${name}, er innbyggjar i Ulsteinvik og er sterkt bekymra over den nye sentrumsplanen som tillater høghus på tomtene SF7 og SF15. Desse bygga vil blokkere sjøutsikta i sentrum, ein uvurderleg kvalitet i vårt lokalsamfunn som områdeplanen (PlanID 20210001, § 1) vektlegg. Sjøfronten er hjartet i Ulsteinvik sin maritime identitet, og vi kan ikkje akseptere at den forsvinn.

Eg foreslår at tomta SF7 blir omgjort til ein stor felles park eller eit ope område, slik at både innbyggjarar og tilreisande kan nyte utsyn mot sjøen. Eg ber kommunen revurdere planen for SF7 og SF15 og prioritere løysingar som bevarer sjøutsikta og tilgangen til sjøfronten. Vennligst bekreft mottak av dette innspelet og hald meg oppdatert på høyringsprosessen.

Med venleg helsing,
\${name}`,

        `Innspel 1 til Ulstein kommune
Dato: \${date}

Eg heiter \${name} og er ein bekymra innbyggjar i Ulsteinvik. Den nye sentrumsplanen, som tillèt høghus på tomta SF7 og SF15, truar sjøutsikta i sentrum – ein uvurderleg kvalitet for lokalsamfunnet vårt. Områdeplanen (§ 1) framhevar nærleiken til sjøen som hjartet i Ulsteinvik sin maritime identitet, og dette kan vi ikkje miste.

Eg foreslår at SF7 blir omgjort til ein felles park eller eit åpent område, slik at både innbyggjarar og besøkande kan nyte fri sikt til sjøen. Eg ber kommunen revurdere planane for SF7 og SF15 og setje sjøfrontens tilgjengelegheit først. Vennligst stadfest mottak av innspelt og hald meg informert om høyringsprosessen.

Med venleg helsing,
\${name}`,

        `Innspel 2 til Ulstein kommune
Dato: \${date}

Som innbyggjar i Ulsteinvik, \${name}, ynskjer eg å gi eit innspel om den nye sentrumsplanen. Eg er sterkt bekymra for at høghus på tomta SF7 og SF15 vil blokkere sjøutsikta, noko som er ein kjerneverdi i lokalsamfunnet og ein del av Ulsteinvik sin maritime sjel. Dette strider mot målsetjinga om å bevare nærleiken til sjøen, som områdeplanen understrekar (§ 1).

Eg foreslår at SF7 i staden vert eit åpent grøntområde for å sikre utsikta til sjøen for alle. Eg oppmodar kommunen til å tenke nytt om SF7 og SF15 og prioritere løysingar som vernar sjøfronten. Eg ser fram til stadfesting på mottak og informasjon om høyringsprosessen.

Med venleg helsing,
\${name}`,

        `Innspel 3 til Ulstein kommune
Dato: \${date}

Eg, \${name}, bur i Ulsteinvik og er djupt uroa over den nye sentrumsplanen som opnar for høghus på tomta SF7 og SF15. Desse byggja vil ta bort sjøutsikta, ein kvalitet som er heilt sentral for identiteten vår som kystby, slik områdeplanen (PlanID 20210001, § 1) også påpeiker. Sjøfronten er ein skatt vi ikkje kan miste.

Eg meiner at SF7 bør bli ein park eller eit åpent område der folk kan nyte sjøen, i staden for å byggje høghus der. Eg ber kommunen om å revurdere planane for SF7 og SF15 og sikre at sjøutsikta blir bevart. Kan de stadfeste mottak av dette innspelt og halde meg oppdatert på høyringsprosessen?

Med venleg helsing,
\${name}`,

        `Innspel 4 til Ulstein kommune
Dato: \${date}

Mitt namn er \${name}, og som innbyggjar i Ulsteinvik vil eg gi eit innspel til den nye sentrumsplanen. Eg er svært bekymra for planane om høghus på SF7 og SF15, sidan dette vil blokkere den verdifulle sjøutsikta i sentrum. Sjøfronten er ein del av Ulsteinvik sin maritime arv og ein kjerneverdi som områdeplanen vektlegg, og vi kan ikkje akseptere at den forsvinn.

Eg foreslår at SF7 vert omforma til eit åpent rekreasjonsområde som sikrar fri utsikt til sjøen for både fastbuande og tilreisande. Eg oppfordrar kommunen til å tenke om igjen om SF7 og SF15 og velje løysingar som tek vare på tilgangen til sjøfronten. Eg ønskjer stadfesting på mottak og informasjon om korleis høyringsprosessen går vidare.

Med venleg helsing,
\${name}`
      ];

      const generateLetter = () => {
        if (!name.trim()) {
          setError('Vennligst skriv inn namnet ditt.');
          return;
        }
        const today = new Date().toLocaleDateString('nn-NO');
        const randomIndex = Math.floor(Math.random() * letterTemplates.length);
        const selectedLetter = letterTemplates[randomIndex]
          .replace(/\${name}/g, name)
          .replace(/\${date}/g, today);
        setLetter(selectedLetter);
        setError('');
        setCopySuccess('');
      };

      const sendEmail = () => {
        try {
          const subject = encodeURIComponent("Innspel til ny sentrumsplan");
          const body = encodeURIComponent(letter.trim());
          const mailtoLink = `mailto:postmottak@ulstein.kommune.no?subject=${subject}&body=${body}`;
          window.location.href = mailtoLink;
          setTimeout(() => {
            if (document.activeElement.tagName !== 'A') {
              setError('Klarte ikkje å opna e-postklienten. Klikk "Kopier brev", lim inn i e-posttenesta di (t.d. Gmail), og send til postmottak@ulstein.kommune.no.');
            }
          }, 1500);
        } catch (e) {
          setError('Feil ved opning av e-postklient. Klikk "Kopier brev", lim inn i e-posttenesta di (t.d. Gmail), og send til postmottak@ulstein.kommune.no.');
        }
      };

      const copyToClipboard = () => {
        try {
          navigator.clipboard.writeText(letter).then(() => {
            setCopySuccess('Brevet er kopiert! Lim det inn i e-posttenesta di og send til postmottak@ulstein.kommune.no.');
            setError('');
            setTimeout(() => setCopySuccess(''), 5000);
          }).catch(() => {
            setError('Klarte ikkje å kopiera. Merk brevet manuelt, kopier, og lim inn i e-posttenesta di.');
            setCopySuccess('');
          });
        } catch (e) {
          setError('Klarte ikkje å kopiera. Merk brevet manuelt, kopier, og lim inn i e-posttenesta di.');
          setCopySuccess('');
        }
      };

      const downloadPDF = () => {
        const element = document.createElement('a');
        const file = new Blob([letter], { type: 'text/plain' });
        element.href = URL.createObjectURL(file);
        element.download = 'innspel_ulstein_kommune.txt';
        document.body.appendChild(element);
        element.click();
        document.body.removeChild(element);
      };

      return (
        <div className="max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-lg">
          <h1 className="text-3xl font-bold text-gray-800 mb-4">Ivareta sjøutsikta i Ulsteinvik sentrum!</h1>
          <p className="text-gray-600 mb-4">
            Den nye sentrumsplanen for Ulsteinvik vil tillata høghus på tomtene <span className="font-semibold">SF7</span> og <span className="font-semibold">SF15</span>, som kan stengja sjøutsikta vår for alltid. Vi foreslår at <span className="font-semibold">SF7</span> blir ein stor felles park eller eit ope område, slik at innbyggjarane kan nyta sjøfronten. <span className="font-semibold">Ikkje la Ulsteinvik mista si maritime sjel!</span> Skriv inn namnet ditt nedanfor og send inn innspela dine innen 27 mai for å ivareta resten av sjøutsikta i sentrum.
          </p>

          {/* SF7-seksjon */}
          <div className="mb-8">
            <h2 className="text-2xl font-semibold text-gray-800 mb-4">SF7 – Trugar sjøutsikta</h2>
            <div className="grid grid-cols-1 gap-4">
              <div className="text-center">
                <img src="SF7_4.png" alt="SF7 Dagens utsikt mot fjorden" className="w-full h-150 object-cover rounded-lg mb-2" />
                <p className="text-gray-600 text-sm">Før: SF7 Dagens utsikt mot fjorden</p>
              </div>
              <div className="text-center">
                <img src="SF7_5.JPG" alt="SF7 Dagens utsikt" className="w-full h-80 object-cover rounded-lg mb-2" />
                <p className="text-gray-600 text-sm">Før: SF7 Dagens utsikt</p>
              </div>
              <div className="text-center">
                <img src="SF7_6.JPG" alt="SF7 med potensiell utbygging" className="w-full h-80 object-cover rounded-lg mb-2" />
                <p className="text-gray-600 text-sm">Etter: SF7 med potensiell utbygging</p>
              </div>
            </div>
            <p className="text-gray-600 mt-2">Vi foreslår at SF7 blir ein felles park utan bygg for å bevara sjøutsikta (jf. s. 8). Illustrasjonane er henta frå kommunen sine eigne sider.</p>
          </div>

          {/* SF15-seksjon */}
          <div className="mb-8">
            <h2 className="text-2xl font-semibold text-gray-800 mb-4">SF15 – Trugar sjøutsikta</h2>
            <div className="grid grid-cols-1 gap-4">
              <div className="text-center">
                <img src="SF15_2.JPG" alt="SF15 før utbygging" className="w-full h-150 object-cover rounded-lg mb-2" />
                <p className="text-gray-600 text-sm">Før: SF15 Dagens utsikt mot sentrum</p>
              </div>
              <div className="text-center">
                <img src="SF15_3.JPG" alt="SF15 Dagens utsikt mot sentrum" className="w-full h-80 object-cover rounded-lg mb-2" />
                <p className="text-gray-600 text-sm">Før: SF15 Dagens utsikt mot sentrum</p>
              </div>
              <div className="text-center">
                <img src="SF15_4.JPG" alt="SF15 med potensiell utbygging" className="w-full h-80 object-cover rounded-lg mb-2" />
                <p className="text-gray-600 text-sm">Etter: SF15 med potensiell utbygging</p>
              </div>
            </div>
            <p className="text-gray-600 mt-2">Vi ber om at SF15 blir vurdert for å unngå tap av sjøutsikt (jf. s. 8). Illustrasjonane er henta frå kommunen sine eigne sider.</p>
          </div>

          {/* Navnefelt og brevfunksjonalitet */}
          <div className="mb-4">
            <label className="block text-gray-700 font-medium mb-2" htmlFor="name">
              Namnet ditt
            </label>
            <input
              id="name"
              type="text"
              value={name}
              onChange={(e) => setName(e.target.value)}
              className="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="Skriv inn heile namnet ditt"
            />
          </div>
          <button
            onClick={generateLetter}
            className="w-full bg-blue-600 text-white p-2 rounded-lg hover:bg-blue-700 transition"
            disabled={!name.trim()}
          >
            Generer brev
          </button>
          {letter && (
            <div className="mt-6 letter-section">
              <h2 className="text-lg font-semibold text-gray-800 mb-2">Brevet ditt</h2>
              <pre className="bg-gray-50 p-4 rounded-lg text-sm text-gray-700 whitespace-pre-wrap">
                {letter}
              </pre>
              {error && (
                <p className="mt-2 text-red-600">{error}</p>
              )}
              {copySuccess && (
                <p className="mt-2 text-green-600">{copySuccess}</p>
              )}
              <div className="flex flex-wrap gap-4 mt-4">
                <button
                  onClick={copyToClipboard}
                  className="bg-blue-500 text-white p-2 rounded-lg hover:bg-blue-600 transition"
                >
                  Kopier brev
                </button>
                <button
                  onClick={sendEmail}
                  className="bg-purple-600 text-white p-2 rounded-lg hover:bg-purple-700 transition"
                >
                  Send brev via e-post
                </button>
                <button
                  onClick={downloadPDF}
                  className="bg-green-600 text-white p-2 rounded-lg hover:bg-green-700 transition"
                >
                  Last ned som tekstfil
                </button>
              </div>
              <p className="mt-4 text-gray-600">
                Klikk "Kopier brev" for å kopiera brevet, lim det inn i e-posttenesta di (t.d. Gmail), og send til postmottak@ulstein.kommune.no. Eller prøv "Send brev via e-post" for å bruka e-postklienten din.
              </p>
            </div>
          )}
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>