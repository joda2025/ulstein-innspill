<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Innspill til Ulstein kommunes sentrumsplan</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.20.15/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
  <div id="root"></div>
  <script type="text/babel">
    function App() {
      const [name, setName] = React.useState('');
      const [letter, setLetter] = React.useState('');
      const [error, setError] = React.useState('');
      const [copySuccess, setCopySuccess] = React.useState('');

      const generateLetter = () => {
        const today = new Date().toLocaleDateString('no-NO');
        const letterContent = `Innspill til Ulstein kommunes sentrumsplan
Dato: ${today}

Kjære Ulstein kommune,

Eg, ${name}, er innbyggjar i Ulsteinvik og er sterkt bekymra for den nye sentrumsplanen som tillater høghus på tomtene SF7 og SF15. Desse bygga vil blokkere sjøutsikten i sentrum, ein uvurderleg kvalitet i vårt lokalsamfunn som områdeplanen (PlanID 20210001, § 1) vektlegg. Sjøfronten er hjartet i Ulsteinviks maritime identitet, og vi kan ikkje akseptere at den forsvinn.

Eg foreslår at tomta SF7 blir omgjort til ein stor felles park eller eit åpent område, slik at innbyggjarane kan nyte sjøen. Eg ber kommunen revurdere planen for SF7 og SF15 og prioritere løsninger som bevarer sjøutsikten og tilgangen til sjøfronten. Vennligst bekreft mottak av dette innspillet og hold meg oppdatert på høyringsprosessen.

Med vennleg helsing,
${name}`;
        setLetter(letterContent);
        setError('');
        setCopySuccess('');
      };

      const sendEmail = () => {
        try {
          const subject = encodeURIComponent("Innspill til ny sentrumsplan");
          const body = encodeURIComponent(letter.trim());
          const mailtoLink = `mailto:johannesdahl@gmail.com?subject=${subject}&body=${body}`;
          window.location.href = mailtoLink;
          setTimeout(() => {
            if (document.activeElement.tagName !== 'A') {
              setError('Kunne ikke åpne e-postklienten. Klikk "Kopier brev", lim inn i din e-post (f.eks. Gmail), og send til johannesdahl@gmail.com.');
            }
          }, 1500);
        } catch (e) {
          setError('Feil ved åpning av e-postklient. Klikk "Kopier brev", lim inn i din e-post (f.eks. Gmail), og send til johannesdahl@gmail.com.');
        }
      };

      const copyToClipboard = () => {
        try {
          navigator.clipboard.writeText(letter).then(() => {
            setCopySuccess('Brevet er kopiert! Lim det inn i din e-posttjeneste og send til johannesdahl@gmail.com.');
            setError('');
            setTimeout(() => setCopySuccess(''), 5000);
          }).catch(() => {
            setError('Kunne ikke kopiere. Marker brevet manuelt, kopier, og lim inn i din e-posttjeneste.');
            setCopySuccess('');
          });
        } catch (e) {
          setError('Kunne ikke kopiere. Marker brevet manuelt, kopier, og lim inn i din e-posttjeneste.');
          setCopySuccess('');
        }
      };

      const downloadPDF = () => {
        const element = document.createElement('a');
        const file = new Blob([letter], { type: 'text/plain' });
        element.href = URL.createObjectURL(file);
        element.download = 'innspill_ulstein_kommune.txt';
        document.body.appendChild(element);
        element.click();
        document.body.removeChild(element);
      };

      return (
        <div className="max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-lg">
          <h1 className="text-3xl font-bold text-gray-800 mb-4">Bevar sjøutsikten i Ulsteinvik sentrum!</h1>
          <p className="text-gray-600 mb-4">
            Den nye sentrumsplanen for Ulsteinvik vil tillate høghus på tomtene <span className="font-semibold">SF7</span> og <span className="font-semibold">SF15</span>, som kan stenge sjøutsikten vår for alltid. Vi foreslår at <span className="font-semibold">SF7</span> blir ein stor felles park eller eit åpent område, slik at innbyggjarane kan nyte sjøfronten. <span className="font-semibold">Ikke la Ulsteinvik miste sin maritime sjel!</span> Skriv inn navnet ditt under og send inn ditt innspill for å bevare sjøutsikten i sentrum.
          </p>

          {/* SF7-seksjon */}
          <div className="mb-8">
            <h2 className="text-2xl font-semibold text-gray-800 mb-4">SF7 – Foreslått som felles park</h2>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div className="text-center">
                <img src="SF7_1.JPG" alt="SF7 før utbygging" className="w-full h-150 object-cover rounded-lg mb-2" />
                <p className="text-gray-600 text-sm">Før: SF7 før utbygging</p>
              </div>
              <div className="text-center">
                <img src="SF7_2.JPG" alt="SF7 under utbygging" className="w-full h-150 object-cover rounded-lg mb-2" />
                <p className="text-gray-600 text-sm">Under: SF7 under utvikling</p>
              </div>
              <div className="text-center">
                <img src="SF7_3.png" alt="SF7 etter utbygging" className="w-full h-100 object-cover rounded-lg mb-2" />
                <p className="text-gray-600 text-sm">Etter: SF7 med potensiell utbygging</p>
              </div>
            </div>
            <p className="text-gray-600 mt-2">Vi foreslår at SF7 blir ein felles park for å bevare sjøutsikten (jf. s. 8).</p>
          </div>

          {/* SF15-seksjon */}
          <div className="mb-8">
            <h2 className="text-2xl font-semibold text-gray-800 mb-4">SF15 – Trugar sjøutsikten</h2>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div className="text-center">
                <img src="SF15_1.png" alt="SF15 før utbygging" className="w-full h-100 object-cover rounded-lg mb-2" />
                <p className="text-gray-600 text-sm">Før: SF15 før utbygging</p>
              </div>
              <div className="text-center">
                <img src="SF15_2.JPG" alt="SF15 under utbygging" className="w-full h-100 object-cover rounded-lg mb-2" />
                <p className="text-gray-600 text-sm">Under: SF15 under utvikling</p>
              </div>
              <div className="text-center">
                <img src="SF15_3.JPG" alt="SF15 etter utbygging" className="w-full h-100 object-cover rounded-lg mb-2" />
                <p className="text-gray-600 text-sm">Etter: SF15 med potensiell utbygging</p>
              </div>
            </div>
            <p className="text-gray-600 mt-2">Vi ber om at SF15 vurderast for å unngå tap av sjøutsikt (jf. s. 8).</p>
          </div>

          {/* Navnefelt og brevfunksjonalitet */}
          <div className="mb-4">
            <label className="block text-gray-700 font-medium mb-2" htmlFor="name">
              Ditt navn
            </label>
            <input
              id="name"
              type="text"
              value={name}
              onChange={(e) => setName(e.target.value)}
              className="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="Skriv inn ditt fulle navn"
            />
          </div>
          <button
            onClick={generateLetter}
            className="w-full bg-blue-600 text-white p-2 rounded-lg hover:bg-blue-700 transition"
            disabled={!name.trim()}
          >
            Generer brev
          </button>
          {letter && (
            <div className="mt-6">
              <h2 className="text-lg font-semibold text-gray-800 mb-2">Ditt brev</h2>
              <pre className="bg-gray-50 p-4 rounded-lg text-sm text-gray-700 whitespace-pre-wrap">
                {letter}
              </pre>
              {error && (
                <p className="mt-2 text-red-600">{error}</p>
              )}
              {copySuccess && (
                <p className="mt-2 text-green-600">{copySuccess}</p>
              )}
              <div className="flex flex-wrap gap-4 mt-4">
                <button
                  onClick={copyToClipboard}
                  className="bg-blue-500 text-white p-2 rounded-lg hover:bg-blue-600 transition"
                >
                  Kopier brev
                </button>
                <button
                  onClick={sendEmail}
                  className="bg-purple-600 text-white p-2 rounded-lg hover:bg-purple-700 transition"
                >
                  Send brev via e-post
                </button>
                <button
                  onClick={downloadPDF}
                  className="bg-green-600 text-white p-2 rounded-lg hover:bg-green-700 transition"
                >
                  Last ned som tekstfil
                </button>
              </div>
              <p className="mt-4 text-gray-600">
                Klikk "Kopier brev" for å kopiere brevet, lim det inn i din e-posttjeneste (f.eks. Gmail), og send til johannesdahl@gmail.com. Alternativt, prøv "Send brev via e-post" for å bruke din e-postklient, eller last ned som tekstfil.
              </p>
            </div>
          )}
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
